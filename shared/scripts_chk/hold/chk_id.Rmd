---
title: "Checking ID Variables"
author: "Megan Schultz and Kendra Wyant"
date: '`r format(Sys.time(), "%Y-%m-%d")`'
output: 
  html_document:
    code_folding: show
    toc: true 
    toc_depth: 3
editor_options: 
  chunk_output_type: console
---
  
### Notes
This script checks ID (individual difference) variables from RISK participants' data by computing 
descriptives and checking for missingness and potential errors. ID variables are considered to be 
demographics and stable traits measured at intake.

#### Error log entries to discuss
var_name (subid): issue
auh_2/scale_auh_age_regular (032): 270 was entered in qualtrics, but for the next question 
"When did you believe you had a problem?", the sub answered 27.

auh_5 (203): According to qualtrics, this sub first tried quitting/thought they had a problem at the age of 32. They 
are currently age 33. So they are reporting quitting 100 times in the past year.
auh_5 (84): 365 quit attempts - Sub is currently 57 years old and first 
tried quitting at age 26. Meaning, he tried quitting approximately once a month for 31 years. May be accurate, but it is skewing our data for this variable. 

au_8_year (204): Listed quit date year as 2020 -> change to 2019 (see comment below)
au_8_year (207): Listed quit date year as 2021 -> change to 2019 (see comment below)
SUSAN Comment: The question was a dropdown with possible values 2016:2021. Both subs ran in March 2019, 
both endorsed the month = February, perhaps they just scrolled to the bottom option assuming it was the 
current year?

Data log screening errors not implemented in cln_database
DEM2_6 (081): Participant responded to question DEM2_6 incorrectly. She made a typo and entered 40, she meant to enter 4
(173): A screen was completed with participant 173. The DataType field was left empty. “Real” should have been selected
SCL90_15 (190): A screen was completed with participant 190 on 2/12/2019. He answered “Quite a bit” for Thoughts of ending your life (Item #15) on the SCL-90, however he reported that this was an accident. He stated that he has no thoughts of ending his life and that he should have responded “not at all.” 

  
### Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, error = TRUE)
```

Paths
```{r}
path_data <- "./analysis/shared/data"
```

Packages
```{r}
library(tidyverse)
library(janitor)
library(psych)
library(lubridate)
library(kableExtra)
```


### Import data and glimpse
```{r}
id <- read_rds(file.path(path_data, "ds_id.rds"))

id_scale <- id %>%
  mutate(time_central = as_datetime(id$utc, tz = 'America/Chicago')) %>%
  select(subid, time_central, contains("scale")) %>%
  glimpse()
```

The ID data file has `r length(unique(id$subid))` unique subids contributing to `r length(id$subid)` 
total observations.

The earliest observation was recorded on `r min(id_scale$time_central)` and the latest was on `r max(id_scale$time_central)`.

Check all items for missing values
```{r}
if(any(is.na(id))){
   id %>%
    summarise(across(everything(), ~sum(is.na(.)))) %>%
    gather(key = "var", value = "num_NA" ) %>%
    filter(num_NA > 0) %>%
    kable() %>%
    kable_styling(full_width = FALSE, position = "left")
}else {
  paste("No missing values")
}
```

There are `r sum(is.na(id))` missing values (NA) in the entire dataset. All variables with missing 
values are conditional (i.e., branch from answer in previous question or not applicable to all 
participants).


### Demographics

#### Descriptives

Age
```{r}
describe(id_scale$scale_dem_age) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_age)) +
  geom_histogram(bins = 12) +
  xlab("age of participant") +
  ggtitle("Histogram of participants' age") +
  theme_classic()
```

Sex
```{r}
id_scale %>% 
  select(sex = scale_dem_sex) %>%
  tabyl(sex, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

Race
```{r}
id_scale %>% 
  select(race = scale_dem_race) %>%
  tabyl(race, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# self-reported race identity if previously selected other/multiracial
id %>% 
  select(multiracial = dem_3_1) %>%
  tabyl(multiracial, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# Hispanic, Latino, or Spanish origin
id_scale %>% 
  select(Hispanic = scale_dem_hispanic) %>%
  tabyl(Hispanic, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# If other orgin - user-inputted text
id %>% 
  select(other = dem_4_1) %>%
  tabyl(other, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_race)) +
  geom_bar() +
  xlab("race of participant") +
  ggtitle("Frequency plot of participants' race") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Education
```{r}
id_scale %>% 
  select(education = scale_dem_educ) %>%
  tabyl(education, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_educ)) +
  geom_bar() +
  xlab("education level") +
  ggtitle("Frequency plot of participants' education level") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Employment
```{r}
id_scale %>% 
  select(employed = scale_dem_employed) %>%
  tabyl(employed, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_employed)) +
  geom_bar() +
  xlab("employment status") +
  ggtitle("Frequency plot of participants' employment status") +
  theme_classic()

id_scale %>% 
  select(employment_type = scale_dem_employ_type) %>%
  tabyl(employment_type, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_employ_type)) +
  geom_bar() +
  xlab("employment type") +
  ggtitle("Frequency plot of participants' type of employment") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


`r sum(id_scale$scale_dem_employ_type == "disabled")` participants (`r round((sum(id_scale$scale_dem_employ_type == "disabled"))/(length(id_scale$scale_dem_employ_type)), 2)`) marked employment type as disabled. 
However, `r (sum(id_scale$scale_dem_employed == "fulltime")) + (sum(id_scale$scale_dem_employed == "parttime"))` participants (`r round(((sum(id_scale$scale_dem_employed == "fulltime")) + (sum(id_scale$scale_dem_employed == "parttime")))/(length(id_scale$scale_dem_employed)), 2)`) previously stated they were employed full or part time. 


Comment KW 7-23-20: (scale_dem_employ_type/scale_dem_employeed) check coding of employed and employ_type?


Income
```{r}
describe(id_scale$scale_dem_income) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_income)) +
  geom_histogram(bins = 12) +
  xlab("income") +
  ggtitle("Histogram of participants' income") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Marital status
```{r}
id_scale %>% 
  select(marital = scale_dem_marital) %>%
  tabyl(marital, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem_marital)) +
  geom_bar() +
  xlab("marital status") +
  ggtitle("Frequency plot of participants' marital status") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Parents
```{r}
# living
id_scale %>% 
  select(living_parents = scale_dem2_liveparents) %>%
  tabyl(living_parents, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem2_liveparents)) +
  geom_bar() +
  xlab("number of living parents") +
  ggtitle("Frequency plot of participants' number of living parents") +
  theme_classic()

# dead
id_scale %>% 
  select(dead_parents = scale_dem2_deadparents) %>%
  tabyl(dead_parents, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem2_deadparents)) +
  geom_bar() +
  xlab("number of dead parents") +
  ggtitle("Frequency plot of participants' number of dead parents") +
  theme_classic()
```

Children
```{r}
# living
id_scale %>% 
  select(living_children = scale_dem2_livekids) %>%
  tabyl(living_children, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem2_livekids)) +
  geom_bar() +
  xlab("number of living children") +
  ggtitle("Frequency plot of participants' number of living children") +
  theme_classic()

ten_plus_children <- id_scale %>%
  select(num_living_children = scale_dem2_livekids, subid) %>%
  filter(num_living_children >= 10) 

ten_plus_children %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

`r nrow(ten_plus_children)` participants reported having 10 or more living children, with the
highest reported number of children being `r max(ten_plus_children$num_living_children)`

```{r}
# dead
id_scale %>% 
  select(dead_children = scale_dem2_deadkids) %>%
  tabyl(dead_children, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dem2_deadkids)) +
  geom_bar() +
  xlab("number of dead children") +
  ggtitle("Frequency plot of participants' number of dead children") +
  theme_classic()
```


### Alcohol use history

#### Descriptives

Reported ages
```{r}
# age first drink
id_scale %>%
  select(age_first_drink = scale_auh_age_first, age_current = scale_dem_age, subid = subid) %>%
  filter(age_first_drink > age_current) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

0 participants reported age of first drink as higher than current age.

```{r}
describe(id_scale$scale_auh_age_first) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_age_first)) +
  geom_histogram(bins = 12) +
  xlab("age of first drink") +
  ggtitle("Histogram of participants' age of first drink") +
  theme_classic()

# age of regular drinking
id_scale %>%
  select(age_regular_drinking = scale_auh_age_regular, age_current = scale_dem_age, subid = subid) %>%
  filter(age_regular_drinking > age_current) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale[id_scale$subid==32, "scale_auh_age_regular"] <- 27  # see comment below block
```


Comment MES 4/16/20: (auh_2, scale_auh_age_regular) Subid 032: 270 was entered in qualtrics, but for the next question 
"When did you believe you had a problem?", the sub answered 27.

Comment KW 7/23/20: temporarily changed scale_auh_age_regular (auh_2) subid 32 to 27 instead of 270 in working db 
but not in db on drive


```{r}
describe(id_scale$scale_auh_age_regular) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_age_regular)) +
  geom_histogram(bins = 12) +
  xlab("age of regular drinking") +
  ggtitle("Histogram of participants' age of regular drinking") +
  theme_classic()
```


```{r}
# age of problem drinking
id_scale %>%
  select(age_problem_drink = scale_auh_age_problem, age_current = scale_dem_age, subid = subid) %>%
  filter(age_problem_drink > age_current) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

0 participants reported age of problem drinking as higher than current age.

```{r}
describe(id_scale$scale_auh_age_problem) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_age_problem)) +
  geom_histogram(bins = 12) +
  xlab("age of problem drinking") +
  ggtitle("Histogram of participants' age of problem drinking") +
  theme_classic()

# age first quit
id_scale %>%
  select(age_first_quit = scale_auh_age_firstquit, age_current = scale_dem_age, subid = subid) %>%
  filter(age_first_quit > age_current) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

0 participants reported age of first quit as higher than current age.

```{r}
describe(id_scale$scale_auh_age_firstquit) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_age_firstquit)) +
  geom_histogram(bins = 12) +
  xlab("age of first quit") +
  ggtitle("Histogram of participants' age of first quit") +
  theme_classic()
```

Number of quit attempts
```{r}
describe(id_scale$scale_auh_times_quit) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_times_quit)) +
  geom_histogram(bins = 12) +
  xlab("number of quit attempts") +
  ggtitle("Histogram of number of participants' quit attempts") +
  theme_classic()

# look at possible outliers
quit_attempt <- id_scale %>% 
  select(quit_attempts = scale_auh_times_quit, subid) %>%
  filter(quit_attempts > 30)

quit_attempt %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```

There are `r nrow(quit_attempt)` subids with more than 30 quit attempts. The highest number of quit
attempts is `r max(quit_attempt$quit_attempts)`.


Comment MES 4/16/20: (auh_5)1. Subid 269: There is a 10 year window between participant's current age 
and first age they tried to quit. So ~9 quit attempts per year. Seems reasonable to me. 2. Subid 203: 
According to qualtrics, this sub first tried quitting/thought they had a problem at the age of 32. They 
are currently age 33. So they are reporting quitting 100 times in the past year. Seems slightly unrealistic depending on how you would classify a quit attempt. 3. Subid 084: Sub is currently 57 years old and first 
tried quitting at age 26. Meaning, he tried quitting approximately once a month for 31 years.

Comment JJC 5/2/20: How to handle? (auh_5 =365) SUSAN COMMENT: subID 84, no correction in datalogs

Comment KW 7/23/20: (auh_5/scale_auh_times_quit = 365) Perhaps we can have a limit (i.e., 100+ attempts)?


Types of treatment
```{r}
# long-term residential
id_scale %>% 
  select(long_residential = scale_auh_program_longres) %>%
  tabyl(long_residential, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# short-term residential
id_scale %>% 
  select(short_residential = scale_auh_program_shortres) %>%
  tabyl(short_residential, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# outpatient
id_scale %>% 
  select(outpatient = scale_auh_program_outpatient) %>%
  tabyl(outpatient, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# individual counseling
id_scale %>% 
  select(individual_counseling = scale_auh_program_individual) %>%
  tabyl(individual_counseling, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# group counseling
id_scale %>% 
  select(group_counseling = scale_auh_program_group) %>%
  tabyl(group_counseling, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# self-help: AA/NA
id_scale %>% 
  select(self_help = scale_auh_program_selfhelp) %>%
  tabyl(self_help, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# other forms of treatment
id_scale %>% 
  select(other_treatment = scale_auh_program_other) %>%
  tabyl(other_treatment, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>% 
  select(other_treatment_types = auh_6_1_2) %>%
  tabyl(other_treatment_types, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")

# total programs
describe(id_scale$scale_auh_program_total) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_auh_program_total)) +
  geom_histogram(bins = 7) +
  xlab("number of programs used") +
  ggtitle("Histogram of number of programs participants used") +
  theme_classic()
```

Prescription medications
```{r}
# used rx meds for alcohol
id_scale %>% 
  select(alcohol_meds = scale_auh_alcmeds) %>%
  tabyl(alcohol_meds, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# prescription meds taken for abstinence
id %>% 
  select(medication = auh_7_1_1_med1) %>%
  tabyl(medication, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")

id %>% 
  select(medication = auh_7_1_2_med2) %>%
  tabyl(medication, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")

id %>% 
  select(medication = auh_7_1_3_med3) %>%
  tabyl(medication, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")

id %>% 
  select(medication = auh_7_1_4_med4) %>%
  tabyl(medication, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")
```

Most recent quit drinking date
```{r}
# year
id %>% 
  select(year = auh_8_year) %>%
  tabyl(year, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left", bootstrap_options = "condensed")

# create ymd column
id <- id %>%
  mutate(scale_quit_date = make_date(auh_8_year, auh_8_month, auh_8_day))

id %>%
  ggplot(aes(x = scale_quit_date)) +
  geom_histogram(bins = 20) +
  xlab("quit drinking date") +
  ggtitle("Histogram of participants' most recent quit drinking date") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


Comment MES 4/16/20: (au_8_year) Based on the visit dates spreadsheet, theses should be 2019. 
SUSAN Comment: The question was a dropdown with possible values 2016:2021. Both subs ran in March 2019, 
both endorsed the month = February, perhaps they just scrolled to the bottom option assuming it was the 
current year?

Comment KW 7/23/20:(auh_8_day) Still need to correct for 2 subids who list 2020 (subid = 204) and 2021 (subid = 207) as sobriety year


Drinking behavior 6 months prior to quitting
```{r}
# days per week drinking
describe(id_scale$scale_auh_freqdrink_sixmonths) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_freqdrink_sixmonths)) +
  geom_histogram(bins = 7) +
  xlab("days per week drinking") +
  ggtitle("Histogram of days/week drinking - 6 mo before quitting") +
  theme_classic()

# days per week drinking 6+ drinks
describe(id_scale$scale_auh_freqbinge_sixmonths) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_freqbinge_sixmonths)) +
  geom_histogram(bins = 7) +
  xlab("days per week drinking 6+ drinks") +
  ggtitle("Histogram of days/week drinking 6+ drinks - 6 mo before quitting") +
  theme_classic()

# number of drinks consumed when drinking
describe(id_scale$scale_auh_quantdrink_sixmonths) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_quantdrink_sixmonths)) +
  geom_histogram(bins = 12) +
  xlab("number of drinks") +
  ggtitle("Histogram of drinks consumed when drinking - 6 mo before quitting") +
  theme_classic()
```

Drinking behavior during heaviest 6 months
```{r}
# days per week drinking
describe(id_scale$scale_auh_freqdrink_heaviest) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_freqdrink_heaviest)) +
  geom_histogram(bins = 7) +
  xlab("days per week drinking") +
  ggtitle("Histogram of days/week drinking - heaviest 6 mo") +
  theme_classic()

# days per week drinking 6+ drinks
describe(id_scale$scale_auh_freqdrink_heaviest) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_freqdrink_heaviest)) +
  geom_histogram(bins = 7) +
  xlab("days per week drinking 6+ drinks") +
  ggtitle("Histogram of days/week drinking 6+ drinks - heaviest 6 mo") +
  theme_classic()

# number of drinks consumed when drinking
describe(id_scale$scale_auh_quantdrink_heaviest) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_auh_quantdrink_heaviest)) +
  geom_histogram(bins = 12) +
  xlab("number of drinks") +
  ggtitle("Histogram of drinks consumed when drinking - heaviest 6 mo") +
  theme_classic()
```

The highest number of drinks consumed when drinking was reported as `r max(id_scale$scale_auh_quantdrink_heaviest)`.


### DSM-5 AUD Checklist

#### Descriptives

Individual checklist items
```{r}
# use over longer periods of time then intended
id %>% 
  select(dsm5_1) %>%
  mutate(dsm5_1 = recode(dsm5_1, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_1, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# tried to cut down or control drinking
id %>% 
  select(dsm5_2) %>%
  mutate(dsm5_2 = recode(dsm5_2, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_2, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# excessive time spent in alcohol-related activities
id %>% 
  select(dsm5_3) %>%
  mutate(dsm5_3 = recode(dsm5_3, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_3, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# reduced involvement in other activities
id %>% 
  select(dsm5_4) %>%
  mutate(dsm5_4 = recode(dsm5_4, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_4, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# continued use despite worsened mental or physical problems
id %>% 
  select(dsm5_5) %>%
  mutate(dsm5_5 = recode(dsm5_5, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_5, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# tolerance
id %>% 
  select(dsm5_6) %>%
  mutate(dsm5_6 = recode(dsm5_6, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_6, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# withdrawal
id %>% 
  select(dsm5_7) %>%
  mutate(dsm5_7 = recode(dsm5_7, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_7, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# failure to fulfill obligations
id %>% 
  select(dsm5_8) %>%
  mutate(dsm5_8 = recode(dsm5_8, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_8, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# use of alcohol in dangerous situations
id %>% 
  select(dsm5_9) %>%
  mutate(dsm5_9 = recode(dsm5_9, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_9, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# strong desires, urges, cravings
id %>% 
  select(dsm5_10) %>%
  mutate(dsm5_10 = recode(dsm5_10, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_10, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

# continued use despite interpersonal problems
id %>% 
  select(dsm5_11) %>%
  mutate(dsm5_11 = recode(dsm5_11, "1" = "No", "2" = "Yes")) %>%
  tabyl(dsm5_11, show_na = TRUE) %>% 
  adorn_totals("row") %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")
```


Comment KW 7-27-20: (dsm5_1 - dsm5_11) Coded individual dsm items as 1 = no and 2 = yes. Confirm this is accurate.


Total DSM score
```{r}
describe(id_scale$scale_dsm5_tot) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_dsm5_tot)) +
  geom_bar() +
  xlab("AUD checklist score (0-11)") +
  ggtitle("Frequency plot of participants' DSM-5 AUD checklist score") +
  theme_classic()
```

The lowest AUD score was `r min(id_scale$scale_dsm5_tot)` and the highest AUD score was `r max(id_scale$scale_dsm5_tot)`, suggesting all participants meet criteria for AUD.

#### Item analysis

```{r}
# alpha
id %>%
  select(contains("dsm5_")) %>%
  select(-scale_dsm5_tot) %>%
  alpha()
```


### Young Adult Alcohol Problems Test (YAP)

#### Descriptives

YAP-life
```{r}
describe(id_scale$scale_yap_life) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_yap_life)) +
  geom_histogram(bins = 10) +
  xlab("YAP life score") +
  ggtitle("Histogram of participants' YAP-life score") +
  theme_classic()
```

YAP-year
```{r}
describe(id_scale$scale_yap_year) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_yap_year)) +
  geom_histogram(bins = 10) +
  xlab("YAP year score") +
  ggtitle("Histogram of participants' YAP-year score") +
  theme_classic()
```

#### Item analysis

YAP-life
```{r}
yap_life <-  id %>%
  select(contains("yap"))

# recode scores
yap_life <- yap_life %>%
  mutate(across(yap_1:yap_8, ~recode(., '1' = 0, '2' = 1, '3' = 1, '4' = 1, '5' = 1, 
                                    '6' = 1, '7' = 1, '8' = 1, '9' = 1, '10' = 1))) %>%
  mutate(across(yap_9:yap_20, ~recode(., '1' = 0, '2' = 1, '3' = 1, '4' = 1, '5' = 1))) %>%
  mutate(across(yap_21:yap_27, ~recode(., '1' = 0, '2' = 1, '3' = 1)))

#item analysis for yap_life recoding
yap_life %>%
  select(-c(scale_yap_life, scale_yap_year)) %>%
  alpha()
```

YAP-year
```{r}
yap_year <-  id %>%
  select(contains("yap"))

# recode scores
yap_year <- yap_year %>%
  mutate(across(yap_1:yap_8, ~recode(., '1' = 0, '2' = 0, '3' = 1, '4' = 1, '5' = 1, 
                                    '6' = 1, '7' = 1, '8' = 1, '9' = 1, '10' = 1))) %>%
  mutate(across(yap_9:yap_20, ~recode(., '1' = 0, '2' = 0, '3' = 1, '4' = 1, '5' = 1))) %>%
  mutate(across(yap_21:yap_27, ~recode(., '1' = 0, '2' = 0, '3' = 1)))

# item analysis
yap_year %>%
  select(-c(scale_yap_life, scale_yap_year)) %>%
  alpha()
```


### WHO-ASSIST V3.0

#### Descriptives

Lifetime use score
```{r}
describe(id$assist_1_all) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = assist_1_all)) +
  geom_bar() +
  xlab("lifetime use score") +
  ggtitle("Frequency plot of participants' ASSIST lifetime use score") +
  theme_classic()
```

Problems score - past 3 mo
```{r}
describe(id$assist_4_all) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = assist_4_all)) +
  geom_histogram(bins = 12) +
  xlab("problems score") +
  ggtitle("Histogram of participants' ASSIST problems score") +
  theme_classic()
```


Comment KW 7-24-20: (assist_4_all) confirm range is correct [range = `r (max(id$assist_4_all)) - (min(id$assist_4_all))`]


Failure score - past 3 mo
```{r}
describe(id$scale_assist_5_all) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_assist_5_all)) +
  geom_histogram(bins = 12) +
  xlab("failure score") +
  ggtitle("Histogram of participants' ASSIST failure score") +
  theme_classic()
```


Comment KW 7-24-20: (scale_assist_5_all) confirm range is correct [range = `r (max(id$scale_assist_5_all)) - (min(id$scale_assist_5_all))`]


Concerns score - past 3 mo
```{r}
describe(id$scale_assist_6_all) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_assist_6_all)) +
  geom_histogram(bins = 12) +
  xlab("concerns score") +
  ggtitle("Histogram of participants' ASSIST concerns score") +
  theme_classic()
```


Comment KW 7-24-20: (scale_assist_6_all) confirm range is correct [range = `r (max(id$scale_assist_6_all)) - (min(id$scale_assist_6_all))`]


Quit attempt score - past 3 mo
```{r}
describe(id$scale_assist_7_all) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_assist_7_all)) +
  geom_histogram(bins = 12) +
  xlab("quit attempt score") +
  ggtitle("Histogram of participants' ASSIST quit attempt score") +
  theme_classic()
```


Comment KW 7-24-20: (scale_assist_7_all) confirm range is correct [range = `r (max(id$scale_assist_7_all)) - (min(id$scale_assist_7_all))`]


Injected drug use score
```{r}
describe(id$scale_assist_8_inject) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id %>%
  ggplot(aes(x = scale_assist_8_inject)) +
  geom_bar() +
  xlab("injected drug use score") +
  ggtitle("Frequency plot of participants' ASSIST injected drug score") +
  theme_classic()
```


### Symptom Checklist-90 (SCL90)

#### Descriptives

Total score
```{r}
describe(id_scale$scale_scl90_tot) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_tot)) +
  geom_histogram(bins = 12) +
  xlab("total SCL90 score") +
  ggtitle("Histogram of participants' total SCL90 score") +
  theme_classic()
```

Somatization score
```{r}
describe(id_scale$scale_scl90_som) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_som)) +
  geom_histogram(bins = 12) +
  xlab("somatization SCL90 score") +
  ggtitle("Histogram of participants' somatization SCL90 score") +
  theme_classic()
```

Obsessive compulsive score
```{r}
describe(id_scale$scale_scl90_oc) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_oc)) +
  geom_histogram(bins = 12) +
  xlab("obsessive compulsive SCL90 score") +
  ggtitle("Histogram of participants' obsessive compulsive SCL90 score") +
  theme_classic()
```

Interpersonal sensitivity score
```{r}
describe(id_scale$scale_scl90_sens) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_sens)) +
  geom_histogram(bins = 12) +
  xlab("interpersonal sensitivity SCL90 score") +
  ggtitle("Histogram of participants' interpersonal sensitivity SCL90 score") +
  theme_classic()
```

Depression score
```{r}
describe(id_scale$scale_scl90_dep) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_dep)) +
  geom_histogram(bins = 12) +
  xlab("depression SCL90 score") +
  ggtitle("Histogram of participants' depression SCL90 score") +
  theme_classic()
```

Anxiousness score
```{r}
describe(id_scale$scale_scl90_anx) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_anx)) +
  geom_histogram(bins = 12) +
  xlab("anxiousness SCL90 score") +
  ggtitle("Histogram of participants' anxiousness SCL90 score") +
  theme_classic()
```

Hostility score
```{r}
describe(id_scale$scale_scl90_ang) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_ang)) +
  geom_histogram(bins = 12) +
  xlab("hostility SCL90 score") +
  ggtitle("Histogram of participants' hostility SCL90 score") +
  theme_classic()
```

Phobic anxiety score
```{r}
describe(id_scale$scale_scl90_pho) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_pho)) +
  geom_histogram(bins = 12) +
  xlab("phobic anxiety SCL90 score") +
  ggtitle("Histogram of participants' phobic anxiety SCL90 score") +
  theme_classic()
```

Paranoid ideation score
```{r}
describe(id_scale$scale_scl90_par) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_par)) +
  geom_histogram(bins = 12) +
  xlab("paranoid ideation SCL90 score") +
  ggtitle("Histogram of participants' paranoid ideation SCL90 score") +
  theme_classic()
```

Psychoticism score
```{r}
describe(id_scale$scale_scl90_psy) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_scl90_psy)) +
  geom_histogram(bins = 12) +
  xlab("psychoticism SCL90 score") +
  ggtitle("Histogram of participants' psychoticism SCL90 score") +
  theme_classic()
```

#### Item analysis

Total scale
```{r}
id  %>% 
  select(contains("scl90")) %>%
  select(-c(scale_scl90_tot, scale_scl90_ang, scale_scl90_anx, scale_scl90_dep, scale_scl90_som, 
            scale_scl90_oc, scale_scl90_sens, scale_scl90_pho, scale_scl90_par, scale_scl90_psy)) %>% 
  alpha()
```

Somatization scale
```{r}
id %>%
  select(c(scl90_42, scl90_52, scl90_58, scl90_56, scl90_12, 
           scl90_49, scl90_27, scl90_48, scl90_4, scl90_53, 
           scl90_1, scl90_40)) %>% 
  alpha()
```

Obsessive compulsive scale
```{r}
id %>% 
  select(c(scl90_10, scl90_28, scl90_3, scl90_38, scl90_45, 
           scl90_46, scl90_51, scl90_55, scl90_65, 
           scl90_9)) %>% 
  alpha()
```

Interpersonal sensitivity scale
```{r}
id %>% 
  select(c(scl90_21, scl90_34, scl90_36, scl90_37, scl90_41, 
           scl90_6, scl90_61, scl90_69, scl90_73)) %>% 
  alpha()
```

Depression scale
```{r}
id %>% 
  select(c(scl90_14, scl90_15, scl90_20, scl90_22, scl90_26, 
           scl90_29, scl90_30, scl90_31, scl90_32, scl90_5, 
           scl90_54, scl90_71, scl90_79)) %>% 
  alpha()
```

Anxiousness scale
```{r}
id %>% 
  select(c(scl90_17, scl90_2, scl90_23, scl90_33, scl90_39, 
           scl90_57, scl90_72, scl90_78, scl90_80, 
           scl90_86)) %>% 
  alpha()
```

Hostility scale
```{r}
id %>% 
  select(c(scl90_11, scl90_24, scl90_63, scl90_67, scl90_74, 
           scl90_81)) %>% 
  alpha()
```

Phobic anxiety scale
```{r}
id %>% 
  select(c(scl90_50, scl90_13, scl90_25, scl90_47, scl90_70, 
           scl90_75, scl90_82)) %>% 
  alpha()
```

Paranoid ideation scale
```{r}
id %>% 
  select(c(scl90_18, scl90_43, scl90_68, scl90_76, scl90_8, 
           scl90_83)) %>% 
  alpha()
```

Psychoticism scale
```{r}
id %>% 
  select(c(scl90_62, scl90_16, scl90_35, scl90_7, scl90_77, 
           scl90_84, scl90_85, scl90_87, scl90_88, 
           scl90_90)) %>% 
  alpha()
```


### Intolerance of Uncertainty Scale (IUS)

#### Descriptives

Total score
```{r}
describe(id_scale$scale_ius_tot) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_ius_tot)) +
  geom_histogram(bins = 15) +
  xlab("IUS total score") +
  ggtitle("Histogram of participants' IUS total score") +
  theme_classic()
```

#### Item analysis

```{r}
id %>% 
  select(contains("ius_")) %>%
  select(-scale_ius_tot) %>% 
  alpha()
```


### Anxiety Sensitivity Index-3 (ASI3)

#### Descriptives

Total score
```{r}
describe(id_scale$scale_asi3_tot) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_asi3_tot)) +
  geom_histogram(bins = 12) +
  xlab("ASI3 total score") +
  ggtitle("Histogram of participants' total ASI3 score") +
  theme_classic()
```

Physical concerns score
```{r}
describe(id_scale$scale_asi3_pc) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_asi3_pc)) +
  geom_histogram(bins = 12) +
  xlab("ASI3 physical concerns score") +
  ggtitle("Histogram of participants' physical concerns ASI3 score") +
  theme_classic()
```

Cognitive concerns score
```{r}
describe(id_scale$scale_asi3_cc) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_asi3_cc)) +
  geom_histogram(bins = 12) +
  xlab("ASI3 cognitive concerns score") +
  ggtitle("Histogram of participants' cognitive concerns ASI3 score") +
  theme_classic()
```

Social concerns score
```{r}
describe(id_scale$scale_asi3_sc) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_asi3_sc)) +
  geom_histogram(bins = 12) +
  xlab("ASI3 social concerns score") +
  ggtitle("Histogram of participants' social concerns ASI3 score") +
  theme_classic()
```

#### Item analysis

Total scale
```{r}
id  %>% 
  select(contains("asi3_")) %>%
  select(-c(scale_asi3_tot, scale_asi3_pc, scale_asi3_cc, 
            scale_asi3_sc)) %>% 
  alpha()
```

Physical scale
```{r}
id %>% 
  select(c(asi3_4, asi3_12, asi3_8, asi3_7, asi3_15, 
           asi3_3)) %>% 
  alpha()
```

Cognitive scale
```{r}
id %>% 
  select(c(asi3_14, asi3_18, asi3_10, asi3_16, asi3_2, 
           asi3_5)) %>% 
  alpha()
```

Social scale
```{r}
id %>% 
  select(c(asi3_9, asi3_6, asi3_11, asi3_13, asi3_17, 
           asi3_1)) %>% 
  alpha()
```


### Distress Tolerance Scale (DTS)

#### Descriptives

Total score
```{r}
describe(id_scale$scale_dts_tot) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dts_tot)) +
  geom_histogram(bins = 12) +
  xlab("DTS total score") +
  ggtitle("Histogram of participants' total DTS score") +
  theme_classic()
```

Tolerance score
```{r}
describe(id_scale$scale_dts_toler) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dts_toler)) +
  geom_histogram(bins = 10) +
  xlab("DTS tolerance score") +
  ggtitle("Histogram of participants' tolerance DTS score") +
  theme_classic()
```

Absorption score
```{r}
describe(id_scale$scale_dts_absorb) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dts_absorb)) +
  geom_histogram(bins = 10) +
  xlab("DTS absorption score") +
  ggtitle("Histogram of participants' absorption DTS score") +
  theme_classic()
```

Appraisal score
```{r}
describe(id_scale$scale_dts_appraise) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dts_appraise)) +
  geom_histogram(bins = 10) +
  xlab("DTS appraisal score") +
  ggtitle("Histogram of participants' appraisal DTS score") +
  theme_classic()
```

Regulation score
```{r}
describe(id_scale$scale_dts_regulate) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_dts_regulate)) +
  geom_histogram(bins = 10) +
  xlab("DTS regulation score") +
  ggtitle("Histogram of participants' regulation DTS score") +
  theme_classic()
```

#### Item analysis

Total scale
```{r}
id %>% 
  select(contains("dts_")) %>%
  select(-c(scale_dts_tot, scale_dts_toler, scale_dts_absorb, 
            scale_dts_appraise, 
            scale_dts_regulate)) %>% 
  alpha(keys = c("dts_1", "dts_3", "dts_5", "dts_2", "dts_4", 
                 "dts_15", "dts_7", 
                 "dts_9", "dts_10", "dts_11", "dts_12", 
                 "dts_8", "dts_13", "dts_14"))
```

Tolerance scale
```{r}
id %>% 
  select(c(dts_1, dts_3, dts_5)) %>% 
  alpha(keys = c("dts_1", "dts_3", "dts_5"))
```

Absorption scale
```{r}
id %>% 
  select(c(dts_2, dts_4, dts_15)) %>% 
  alpha(keys = c("dts_2", "dts_4", "dts_15"))
```

Appraisal scale
```{r}
id %>% 
  select(c(dts_6, dts_7, dts_9, dts_10, dts_11, dts_12)) %>% 
  alpha(keys = c("dts_7", "dts_9", "dts_10", "dts_11", 
                 "dts_12"))
```

Regulation scale
```{r}
id %>% 
  select(c(dts_8, dts_13, dts_14)) %>% 
  alpha(keys = c("dts_8", "dts_13", "dts_14"))
```


### Mcmaster Family Assessment Device (FAD)

#### Descriptives

Problem solving score
```{r}
describe(id_scale$scale_fad_prob) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_prob)) +
  geom_histogram(bins = 11) +
  xlab("FAD problem solving score") +
  ggtitle("Histogram of participants' problem solving FAD score") +
  theme_classic()
```

Communication score
```{r}
describe(id_scale$scale_fad_comm) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_comm)) +
  geom_histogram(bins = 12) +
  xlab("FAD communication score") +
  ggtitle("Histogram of participants' communication FAD score") +
  theme_classic()
```

Roles score
```{r}
describe(id_scale$scale_fad_role) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_role)) +
  geom_histogram(bins = 12) +
  xlab("FAD roles score") +
  ggtitle("Histogram of participants' roles FAD score") +
  theme_classic()
```

Affective responsiveness score
```{r}
describe(id_scale$scale_fad_resp) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_resp)) +
  geom_histogram(bins = 11) +
  xlab("FAD affective responsiveness score") +
  ggtitle("Histogram of participants' affective responsiveness FAD score") +
  theme_classic()
```

Affective involvement score
```{r}
describe(id_scale$scale_fad_inv) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_inv)) +
  geom_histogram(bins = 12) +
  xlab("FAD affective involvement score") +
  ggtitle("Histogram of participants' affective involvement FAD score") +
  theme_classic()
```

Behavior control score
```{r}
describe(id_scale$scale_fad_beh) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_beh)) +
  geom_histogram(bins = 12) +
  xlab("FAD behavior control score") +
  ggtitle("Histogram of participants' behavior control FAD score") +
  theme_classic()
```

General functioning score
```{r}
describe(id_scale$scale_fad_gen) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_fad_gen)) +
  geom_histogram(bins = 12) +
  xlab("FAD general functioning score") +
  ggtitle("Histogram of participants' general functioning FAD score") +
  theme_classic()
```

#### Item analysis

Problem solving scale
```{r}
id %>% 
  select(c(fad_2, fad_12, fad_24, fad_38, fad_50, 
           fad_60)) %>% 
  alpha()
```

Communication scale
```{r}
id %>% 
  select(c(fad_3, fad_18, fad_29, fad_43, fad_59, fad_14, 
           fad_22, fad_35, fad_52)) %>% 
  alpha(c("fad_14", "fad_22", "fad_35", "fad_52"))
```

Roles scale
```{r}
id %>% 
  select(c(fad_10, fad_30, fad_40, fad_4, fad_8, fad_15, 
           fad_23, fad_34, fad_45, fad_53, fad_58)) %>% 
  alpha(c("fad_4", "fad_8", "fad_15", "fad_23", "fad_34", 
          "fad_45", "fad_53", "fad_58"))
```

Affective responsiveness scale
```{r}
id %>% 
  select(c(fad_49, fad_57, fad_9, fad_19, fad_28, 
           fad_39)) %>% 
  alpha(c("fad_9", "fad_19", "fad_28", "fad_39"))
```

Affective involvement scale
```{r}
id %>% 
  select(c(fad_5, fad_13, fad_25, fad_33, fad_37, fad_42, 
           fad_54)) %>% 
  alpha(c("fad_5", "fad_13", "fad_25", "fad_33", "fad_37", 
          "fad_42", "fad_54"))
```

Behavior control scale
```{r}
id %>% 
  select(c(fad_20, fad_32, fad_55, fad_7, fad_17, fad_27, 
           fad_44, fad_47, fad_48)) %>% 
  alpha(c("fad_7", "fad_17", "fad_27", "fad_44", "fad_47", 
          "fad_48"))
```

General functioning scale
```{r}
id %>% 
  select(c(fad_6, fad_16, fad_26, fad_36, fad_46, fad_56, 
           fad_1, fad_11, fad_21, fad_31, fad_41, 
           fad_51)) %>% 
  alpha(c("fad_1", "fad_11", "fad_21", "fad_31", "fad_41", 
          "fad_51"))
```


### Multidimensional Personality Questionnaire - Brief Form (MPS)

#### Descriptives

Wellbeing score
```{r}
describe(id_scale$scale_mps_wb) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_wb)) +
  geom_bar() +
  xlab("MPS wellbeing score") +
  ggtitle("Frequency plot of participants' wellbeing MPS score") +
  theme_classic()
```

Social potency score
```{r}
describe(id_scale$scale_mps_sp) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_wb)) +
  geom_bar() +
  xlab("MPS social potency score") +
  ggtitle("Frequency plot of participants' social potency MPS score") +
  theme_classic()
```

Achievement score
```{r}
describe(id_scale$scale_mps_ac) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_ac)) +
  geom_bar() +
  xlab("MPS achievement score") +
  ggtitle("Frequency plot of participants' achievement MPS score") +
  theme_classic()
```

Social closeness score
```{r}
describe(id_scale$scale_mps_sc) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_sc)) +
  geom_bar() +
  xlab("MPS social closeness score") +
  ggtitle("Frequency plot of participants' social closeness MPS score") +
  theme_classic()
```

Stress reaction score
```{r}
describe(id_scale$scale_mps_sr) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_sr)) +
  geom_bar() +
  xlab("MPS stress reaction score") +
  ggtitle("Frequency plot of participants' stress reaction MPS score") +
  theme_classic()
```

Alienation score
```{r}
describe(id_scale$scale_mps_al) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_al)) +
  geom_bar() +
  xlab("MPS alienation score") +
  ggtitle("Frequency plot of participants' alienation MPS score") +
  theme_classic()
```

Aggresion score
```{r}
describe(id_scale$scale_mps_ag) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_ag)) +
  geom_bar() +
  xlab("MPS aggression score") +
  ggtitle("Frequency plot of participants' aggression MPS score") +
  theme_classic()
```

Control score
```{r}
describe(id_scale$scale_mps_ct) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_ct)) +
  geom_bar() +
  xlab("MPS control score") +
  ggtitle("Frequency plot of participants' control MPS score") +
  scale_x_continuous(breaks = seq(0, 12, 4)) +
  theme_classic()
```

Harm avoidance score
```{r}
describe(id_scale$scale_mps_ha) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_ha)) +
  geom_bar() +
  xlab("MPS harm avoidance score") +
  ggtitle("Frequency plot of participants' harm avoidance MPS score") +
  theme_classic()
```

Traditionalism score
```{r}
describe(id_scale$scale_mps_td) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_td)) +
  geom_bar() +
  xlab("MPS traditionalism score") +
  ggtitle("Frequency plot of participants' traditionalism MPS score") +
  scale_x_continuous(breaks = seq(0, 12, 4)) + 
  theme_classic()
```

Absorption score
```{r}
describe(id_scale$scale_mps_ab) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_ab)) +
  geom_bar() +
  xlab("MPS absorption score") +
  ggtitle("Frequency plot of participants' absorption MPS score") +
  theme_classic()
```

Unlikely virtues score
```{r}
describe(id_scale$scale_mps_uv) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_uv)) +
  geom_bar() +
  xlab("MPS unlikely virtues score") +
  ggtitle("Frequency plot of participants' unlikely virtues MPS score") +
  scale_x_continuous(breaks = seq(0, 12, 4)) + 
  theme_classic()
```

Agentic positive emotionality trait score
```{r}
describe(id_scale$scale_mps_pag) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_pag)) +
  geom_histogram(bins = 12) +
  xlab("agentic positive emotionality trait score") +
  ggtitle("Histogram of participants' agentic positive emotionality trait score (from MPS)") +
  theme_classic()
```

Communal positive emotionality trait score
```{r}
describe(id_scale$scale_mps_pco) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_pco)) +
  geom_histogram(bins = 12) +
  xlab("communal positive emotionality trait score") +
  ggtitle("Histogram of participants' communal positive emotionality trait score (from MPS)") +
  theme_classic()
```

Agentic negative emotionality trait score
```{r}
describe(id_scale$scale_mps_nag) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_nag)) +
  geom_histogram(bins = 12) +
  xlab("agentic negative emotionality trait score") +
  ggtitle("Histogram of participants' agentic negative emotionality trait score (from MPS)") +
  theme_classic()
```

Alienated negative emotionality trait score
```{r}
describe(id_scale$scale_mps_nal) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_nal)) +
  geom_histogram(bins = 12) +
  xlab("alienated negative emotionality trait score") +
  ggtitle("Histogram of participants' alienated negative emotionality trait score (from MPS)") +
  theme_classic()
```

Positive emotionality trait score
```{r}
describe(id_scale$scale_mps_pem) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_pem)) +
  geom_histogram(bins = 12) +
  xlab("positive emotionality trait score") +
  ggtitle("Histogram of participants' positive emotionality trait score (from MPS)") +
  theme_classic()
```

Negative emotionality trait score
```{r}
describe(id_scale$scale_mps_nem) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_nem)) +
  geom_histogram(bins = 12) +
  xlab("negative emotionality trait score") +
  ggtitle("Histogram of participants' negative emotionality trait score (from MPS)") +
  theme_classic()
```

Constant trait score
```{r}
describe(id_scale$scale_mps_con) %>%
  kable() %>%
  kable_styling(full_width = FALSE, position = "left")

id_scale %>%
  ggplot(aes(x = scale_mps_con)) +
  geom_histogram(bins = 12) +
  xlab("constant trait score") +
  ggtitle("Histogram of participants' constant trait score (from MPS)") +
  theme_classic()
```

#### Item analysis

Wellbeing scale
```{r}
id %>% 
  select(c(mps_1, mps_26, mps_38, mps_50, mps_62,  mps_74, 
           mps_85, mps_97, mps_109,mps_121, mps_133,
           mps_144)) %>% 
  alpha()
```

Social potency scale
```{r}
id %>% 
  select(c(mps_2, mps_15, mps_39, mps_51, mps_7, mps_87, 
           mps_110, mps_63, mps_98, mps_122, mps_134, 
           mps_145)) %>% 
  alpha(c("mps_63", "mps_98", "mps_122", 
          "mps_134","mps_145"))
```

Achievement scale
```{r}
id %>% 
  select(c(mps_3, mps_16, mps_27, mps_52, mps_76, mps_88, 
           mps_111, mps_123,mps_135,mps_146, mps_64, 
           mps_99)) %>% 
  alpha(c("mps_64", "mps_99"))
```

Social closeness scale
```{r}
id %>% 
  select(c(mps_5, mps_40, mps_77, mps_112, mps_17, mps_28, 
           mps_65, mps_89, mps_100,mps_124, mps_136,
           mps_148)) %>% 
  alpha(c("mps_17", "mps_28", "mps_65", "mps_89", 
          "mps_100","mps_124", "mps_136","mps_148"))
```

Stress reaction scale
```{r}
id %>% 
  select(c(mps_6, mps_18, mps_29, mps_41, mps_53,  mps_78, 
           mps_90, mps_101, mps_113, mps_125, mps_137, 
           mps_149)) %>% 
  alpha()
```

Alienation scale
```{r}
id %>% 
  select(c(mps_7, mps_19, mps_30, mps_42, mps_54, mps_66, 
           mps_91, mps_102, mps_114, mps_126, mps_138, 
           mps_150)) %>% 
  alpha()
```

Aggresion scale
```{r}
id %>% 
  select(c(mps_8, mps_20, mps_31, mps_43, mps_55, mps_67, 
           mps_103, mps_115, mps_127, mps_139, mps_151, 
           mps_79)) %>% 
  alpha("mps_79")
```

Control scale
```{r}
id %>% 
  select(c(mps_9, mps_44, mps_56, mps_68, mps_92,  mps_116, 
           mps_128, mps_140, mps_21, mps_33, mps_80, 
           mps_152)) %>% 
  alpha(c("mps_21", "mps_33", "mps_80", "mps_152"))
```

Harm avoidance scale
```{r}
id %>% 
  select(c(mps_57, mps_141, mps_11, mps_22, mps_34, mps_46, 
           mps_69, mps_81, mps_93, mps_105, mps_129,  
           mps_153)) %>% 
  alpha(c("mps_11", "mps_22", "mps_34", "mps_46", "mps_69", 
          "mps_81", "mps_93", "mps_105", "mps_129",  
          "mps_153"))
```

Traditionalism scale
```{r}
id %>% 
  select(c(mps_12, mps_23, mps_35, mps_58, mps_82, mps_94, 
           mps_106, mps_142, mps_154, mps_47, mps_70, 
           mps_118)) %>% 
  alpha(c("mps_47", "mps_70", "mps_118"))
```

Absorption scale
```{r}
id %>% 
  select(c(mps_13, mps_24, mps_36, mps_48, mps_59, mps_71, 
           mps_83, mps_95, mps_107, mps_119,  mps_130, 
           mps_155)) %>% 
  alpha()
```

Unlikely virtues scale
```{r}
id %>% 
  select(c(mps_25, mps_49, mps_72, mps_96, mps_120, mps_143, 
           mps_147, mps_4, mps_14, mps_37, mps_61, mps_84,  
           mps_108, mps_131)) %>% 
  alpha(c( "mps_4", "mps_14", "mps_37", "mps_61", "mps_84",  
           "mps_108","mps_131"))
```


