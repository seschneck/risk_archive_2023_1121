---
title: "mak_demographics.RMD"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

##Summarize Age, sex, race, ethnicity, & income for final Risk N = 154

### Environment and setup
```{r,results="hide"}
# Libraries
library("tidyverse")
library("StudySupport")
library("scales")


# Set paths
data_path <- "P:/StudyData/RISK/Analysis/shared/data"
```

### Get Valid subIDs
```{r,results="hide"}
valid_subs <- read_rds(file.path(data_path,"valid_subIDs.rds"))
```

### Open and process ID data file containing demographics
```{r,results="hide"}
dem_data <- read_rds(file.path(data_path, "ID.rds")) %>%
#select/rename relevant columns
  select(SubID, 
         age = DEM_1, 
         sex = DEM_2, 
         race = DEM_3, 
         hispanic = DEM_4,
         income = DEM_7) %>%
#recode categorical variables for percentages
  mutate(sex = recode(sex, 
                         `1`="Female",
                         `2`="Male"),
         race = recode(race,
           `1` = "American Indian/Alaska Native",
           `2` = "Asian",
           `3` = "Native Hawaiian or Other Pacific Islander",
           `4` = "Black/African American",
           `5` = "White/Caucasian",
           `6` = "Other/Multiracial"),
         hispanic = recode(hispanic,
           `1` = "No",
           `2` = "Yes",
           `3` = "Yes",
           `4` = "Yes",
           `5` = "Yes")) %>%
 #filter by valid subIDs
  filter(SubID %in% valid_subs$SubID)

```


### Age
```{r}

age_summary <- dem_data %>%
  summarize(mean=round(mean(age),1), sd=round(sd(age),1), min=min(age), max=max(age))
age_summary
```


### Sex
```{r}
sex_summary <- dem_data %>%
  group_by(sex) %>%
  summarize(n = n()) %>%
  mutate(`%` = percent(n/sum(n)))
sex_summary
```


### Race
```{r}
race_summary <- dem_data %>%
  group_by(race) %>%
  summarize(n = n()) %>%
  mutate(`%` = percent(n/sum(n)))
race_summary
```


### Ethnicity
```{r}
hisp_summary <- dem_data %>%
  group_by(hispanic) %>%
  summarize(n = n()) %>%
  mutate(`%` = percent(n/sum(n)))
hisp_summary  
```


### Income
```{r}
income_summary <- dem_data %>%
  summarize(mean=dollar(round(mean(income))), sd=dollar(round(sd(income))), min=dollar(min(income)), max=dollar(max(income)))
income_summary
```


### Conclusions

This sample contains `r nrow(valid_subs)` Risk participants who completed through Followup Visit 1. Mean age is `r age_summary[[1]]` (sd=`r age_summary[[2]]`) and `r sex_summary[[1,3]]` are `r sex_summary[[1,1]]`. The sample is `r race_summary[[5,3]]` `r race_summary[[5,1]]` and `r hisp_summary[[2,3]]` are hispanic.  The average sample income is `r income_summary[[1]]` (sd=`r income_summary[[2]]`).
